myApp.controller("searchAnalysis",["$scope","$http","NgTableParams","$timeout",function(n,t,i,r){var f,u;window.hub.stop();f=this;n.query="";n.currentPage=1;t.post("/search/HotKey").then(function(t){t.data.Success?n.agg=t.data.Data:window.notie.alert({type:3,text:t.data.Message,time:4})});n.paginationConf={currentPage:1,itemsPerPage:10,pagesLength:25,perPageOptions:[1,5,10,15,20,30,40,50],rememberPerPage:"perPageItems",onChange:function(){u&&r.cancel(u);u=r(function(){f.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage);u=null},100)}};n.search=function(){u&&r.cancel(u);u=r(function(){f.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage);u=null},1e3)};this.GetPageData=function(r,u){t.post("/search/SearchList",{page:r,size:u,search:n.query}).then(function(t){t.data.TotalCount>0?(n.paginationConf.currentPage=r,n.paginationConf.totalItems=t.data.TotalCount,$("#interview").next("div[ng-table-pagination]").remove(),f.tableParams=new i({count:5e4},{filterDelay:0,dataset:t.data.Data})):window.notie.alert({type:3,text:t.data.Message,time:4})})};f.del=function(t){swal({title:"确认删除这条记录吗？",text:t.Title,showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",showLoaderOnConfirm:!0,animation:!0,allowOutsideClick:!1}).then(function(){n.request("/search/delete",{id:t.Id},function(n){window.notie.alert({type:1,text:n.Message,time:4})});f.GetPageData(n.paginationConf.currentPage,n.paginationConf.itemsPerPage)},function(){}).catch(swal.noop)};n.addToBlackList=function(n){swal({title:"确认添加黑名单吗？",text:"将"+n+"添加到黑名单",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"确定",cancelButtonText:"取消",animation:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0,preConfirm:function(){return new Promise(function(i,r){t.post("/system/AddToBlackList",{ip:n},{"Content-Type":"application/x-www-form-urlencoded"}).then(function(n){i(n.data)},function(){r("请求服务器失败！")})})}}).then(function(n){n.Success?swal("添加成功","","success"):swal("添加失败","","error")}).catch(swal.noop)}}]);